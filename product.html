<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <title>Жемчужина · Карточка изделия</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header class="topbar">
    <div class="topbar-left">
      <a href="/index.html" class="logo-link">
        <img src="/logo_zhem.svg" alt="Жемчужина" class="logo-img">
      </a>
    </div>

    <a href="order.html" class="cart-link">
      Заказ
      <span id="cartCount" class="cart-count">0</span>
    </a>
  </header>

  <main class="container">
    <a href="catalog.html" class="back-link">← Каталог</a>

    <section id="product"></section>
  </main>

  <div class="toast"></div>
  <script type="module" src="./src/main.js"></script>
  <script type="module">
    if (!location.pathname.endsWith("product.html")) return;

    const applyPrimaryPhoto = () => {
      const params = new URLSearchParams(location.search);
      const sku = params.get("sku");
      if (!sku) return;

      const photoWrap = document.querySelector(".product-photo-wrap");
      const imgEl = photoWrap && photoWrap.querySelector("img");
      if (!imgEl || !photoWrap) return;

      imgEl.src = `/img/products/${encodeURIComponent(sku)}_1.jpg`;
      imgEl.onerror = () => {
        imgEl.style.display = "none";
        photoWrap.style.background = "#fff";
      };
    };

    if (document.readyState === "complete" || document.readyState === "interactive") {
      applyPrimaryPhoto();
    } else {
      document.addEventListener("DOMContentLoaded", applyPrimaryPhoto);
    }
  </script>
</body>
</html>
